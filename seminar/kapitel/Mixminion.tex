\chapter{Typ-III Remailer}
Die als Typ-II klassifizierten Mixmaster-Remailer gelten allgemein in der Praxis als sicher. Trotzdem wurde das Mixminion-Remailer Protokoll entworfen. Mixminion-Remailer stellen den Typ-III der Remailerklassifizierung dar. Die signifikanten Neuerungen, die mit dem Mixminion-Remailer Protokoll eingeführt wurden, waren:
\begin{itemize}
\item das Antworten auf anonyme Nachrichten
\item verschlüsselte Kommunikation zwischen den Remailern (TLS statt SMTP)
\item Einführung einer Verzeichnisserverstruktur
\end{itemize}

Das Möglichkeit auf eine empfangene anonyme Nachricht zu antworten ist der entscheidende Vorteil der Mixminion-Remailer. Kein anderes anonymisierendes Remailer Protokoll (Typ-I und Typ-II) unterstützt dieses Feature nativ.

Die Mixminion-Remailer sind, äquivalent zu den vorherigen Remailer Protokollen, eine Weiterentwicklung des vorherigen Protokolls. So bilden die Mixmaster-Remailer die technische Grundlage für die Entwicklung des Mixminion Protokolls.
- Weiterentwicklung dient nicht primär der Sicherheit (Mixmaster gilt schon als sehr sicher), sondern der generell der Funktionalität


\section{Funktionsweise}
\subsection{SURBs}
Die Single-Use-Reply-Blocks\footnote{kurz: SURBs} wurden eingeführt, um dem Empfänger das Antworten auf eine empfangene anonyme Nachricht zu ermöglichen. Dabei soll die Anonymität des  Senders einer anonymen Nachricht jedoch erhalten bleiben.

Betrachtet man die Lage basierend auf den vorherigen Remailer-Protokollen, kann Bob eigentlich nicht auf eine über ein Remailer-Netzwerk versandte Nachricht von Alice antworten. Das liegt daran, dass ihm lediglich die Identität des letzten Remailers bekannt ist, er die Identität von Alice jedoch nicht kennt.

Um Bob ein Antworten zu ermöglichen, erstellt Alice einen Single-Use-Reply-Block und hängt diese an die Nachricht an. Der SURB befindet sich dabei in verschlüsselter Form im Header der Nachricht. 
Ein SURB enthält zwei wichtige Informationen:
\begin{itemize}
\item die E-Mail Adresse von Alice in verschlüsselter Form
\item einen Pfad durch das Remailer-Netzwerk zu Alice
\end{itemize}

Wichtig ist, dass der SURB selbst für den Empfänger nicht entschlüsselbar ist. Bob ist weiterhin nicht in der Lage die Identität von Alice zu entschlüsseln. Dazu ist lediglich ein Mixminion-Remailer in der Lage. Bob kann jedoch den SURB dazu verwenden um Alice auf ihre anonyme Nachricht zu antworten. Hierfür hängt Bob seine Antwortnachricht an den SURB an und verschickt dieses Konstrukt an den ersten Remailer des im SURB vorhandenen Remailerpfades. Der letzte Remailer dieses Pfades ist nun dazu in der Lage die Adresse von Alice zu entschlüsseln um die Antwort letztendlich an Alice weiterzuleiten.

Bob kann dabei pro empfangenen SURB nur eine Nachricht an Alice schicken. Das liegt daran, dass ein SURB nur einfach verwendbar ist\footnote{daher SINGLE-USE-Reply-Block}. Möchte Bob Alice eine weitere Nachricht schicken, muss er auf eine weitere Nachricht von Alice, die einen SURB enthält, warten, um diesen SURB für eine erneute Antwort zu verwenden. Nach der einmaligen Verwendung eines SURBs werden alle weiteren Nachrichten, die mit Hilfe dieses SURBs versendet werden, wie Duplikate betrachtet und verworfen.

\subsection{Nachrichten}
\subsubsection{Typisierung}
Bisher existierten in den Remailer-Protkollen nur eine Art von Nachricht -- eine anonyme Nachricht von Alice an Bob. Die Hinzunahme von Antwortnachrichten, die gesondert behandelt werden müssen, ist die Einführung einer Typisierung von Nachrichten für das Mixminion-Remailer Protokoll unerlässlich. Hierbei werden zwischen drei Arten von Nachrichten unterschieden\footnote{vgl. S. 4 \cite{mixminion}}:

\begin{enumerate}
\item normale Nachrichten
\item direkte Antworten über SURBs
\item anonyme Antworten
\end{enumerate}

Eine normale Nachricht entspricht hierbei einer anonymisierten Nachricht von Alice zu Bob, wie sie aus den bisherigen Protokollen bekannt ist. Bei einer direkten Antwort über einen SURB gibt Bob bei der Antwort seine Identität preis. Da er nicht weiß, ob er wirklich Alice antwortet, denkbar wäre auch, dass Alice die Adresse eines Dritten in dem SURB angegeben hat, ist es wünschenswert, dass Bob ebenfalls die Möglichkeit hat bei einer Antwort anonym zu bleiben\footnote{das ist nur ein beispielhafter Grund. Logischerweise könnte Bob auch aus anderen Gründen anonym bleiben wollen}. Hierfür existiert die dritte Art einer Nachricht. Hierbei bleibt die Identität von Bob auch dem Empfänger der Antwort verborgen.

\subsubsection{Ununterscheidbarkeit}
Bereits in den vorherigen Kapiteln wurde darauf hingewiesen, dass es für die Gewährleistung der Sicherheit unerlässlich ist, dass der Datenverkehr innerhalb des Remailer-Netzwerks für einen potentiellen Angreifer Eve transparent sein muss. Eve darf nicht dazu in der Lage sein durch die Analyse des Datenverkehrs eine Verbindung zwischen einkommenden und ausgehenden Nachrichtenvekehr herstellen zu können.

Dieser Zustand muss auch nach der Einführung verschiedener Nachrichtentypen erhalten bleiben.  Die Nachrichtentypen müssen daher nach außen hin ununterscheidbar bleiben. Das ist wichtig, damit es Eve nicht möglich ist, über die Unterscheidung der Nachrichtentypen Rückschlüsse bezüglich des Nachrichtenverkehrs zu ziehen. Diese Transparenz wird dadurch gewährleistet, dass alle drei Nachrichtenarten strukturell identisch aufgebaut sind. Sie verfügen über gleichgroße Header- und Bodygrößen\footnote{Body wird häufig auch Payload genannt.}.

\subsubsection{Strukturen der unterschiedlichen Typen}
Die Nachrichten die in einem Mixminion-Remailer Netzwerk verschickt werden, sind grundsätzlich ingesamt 32kB groß. Durch diese Gleichförmigkeit der Größe liefert eine Analyse des Traffic keinen Aufschluss darüber, welche Arten von Nachrichten gerade in dem Remailer-Netzwerk ausgetauscht werden.

Jede Nachricht im Mixminion-Protokoll besteht dabei grundlegend aus den Komponenten 
\begin{itemize}
\item Header
	\begin{itemize}
	\item primärer Header
	\item sekundärer Header
	\end{itemize}
\item Body (Payload)
\end{itemize}

Signifikant ist, dass der Header sich in zwei Teile aufteilt -- dem primären und dem sekundären Header. Dabei haben sowohl der primäre als auch der sekundäre Header jeweils eine Größe von 2kB und der Body eine Größe von 28kB. Der Body einer Nachricht enthält, unabhängig vom Typ der Nachricht, in jedem Fall die eigentlich zu übertragende Information; im letzten Schritt also die Nachricht des Senders an den Empfänger. Die Typisierung einer Nachricht wird durch den Inhalt des primären und sekundären Headers unterschieden.

(hier Bild mit Struktur der drei Nachrichtentypen, wichtig ist der Inhalt der Header, einfach in Textform rein? Bild aus http://www.mixminion.net/minion-design.pdf seite 4 nehmen!)

Die obige Abbildung beschreibt den Inhalt des primären und des sekundären Header in den verschiedenen Nachrichtenfällen.
Man sieht, dass sowohl der primäre als auch der sekundäre Header im Falle einer normalen Nachricht, als auch der primäre Header im Falle einer anonymen Antwort, Pfadinformationen durch das Netzwerk beinhalten.
Ein solcher Pfad ist selbst wieder in Subheader aufgeteilt. Jeder Subheader entspricht hierbei einem Datum für einen Remailer des Pfades. Ein solcher Subheader beinhaltet im wesentlichen drei Daten
\begin{itemize}
\item ein Master-Secret für die Erstellung eines symmetrischen Schlüssels für den Aufbau einer verschlüsselten Verbindung zum nächsten Remailer im Pfad
\item eine Adresse des nächsten Remailers im Pfad
\item eine Prüfsumme zum Überprüfen der Integrität des Rests des Headers
\end{itemize}
Der Pfad des primären und der Pfad des sekundären Headers ergeben, im Falle einer normalen Nachricht, zusammen den Gesamtpfad der Nachricht durch das Remailer-Netzwerk zum Empfänger. Dabei entspricht der Pfad im primären Header dem ersten Teil, der Teil im sekundären Header dem zweiten Teil des Pfades.
Sowohl der primäre als auch der sekundäre Header können sich maximal aus 16 dieser Subheader zusammensetzen. Demzufolge ist die maximale Länge der Route einer normalen Nachricht im Mixminion-Protokoll 32.

Bei einer direkten Antwort von Bob ist der SURB im primären Header der, der von Alice zum Antworten übermittelt wurde. Da in diesem alle Informationen enthalten sind, die benötigt werden um die Nachricht bis Alice durchzustellen, befinden sich im sekundären Header in diesem Fall keine signifikanten Informationen. Um den gleichartigen Schein zu wahren, wird der sekundäre Header mit Platzhalterdaten gefüllt.

Bei einer anonymen Antwort befindet sich der SURB von Alice im sekundären Header. Im primären Header befindet sich ein von Bob spezifizierter Pfad durch das Netzwerk, der vor dem Pfad des SURBs durchlaufen wird. Dadurch bleibt die Identität von dem Antworter Bob dem Empfänger der Antwort verborgen\footnote{vgl. S. 4 \cite{mixminion}}.

\subsection{Verzeichnisserver}
- Verzeichnis auf mehrere Server verteilt
- alle VZ-Server werden ständig synchronisiert, sind also zueinander redundant
- VZ-Server verifizieren sich gegenseitig, um Einführen von manipulierten VZ-Servern zu vermeiden.
-- soll ausfallsicherheit gewährleisten
- informiert Benutzer über Status und Schlüssel der versch. Remailer im Netzwerk
- jeder Remailer im Netzwerk registriert sich anfangs beim Verzeichnisserver
- Remailer aktualisiert VZ-Server laufend über Zustand und Schlüssel

\section{Ablauf}
- Alice besorgt sich vom VZ-Server alle benötigten Informationen (Status und Schlüssel), um Pfad auszuwählen.
- Versenden und Verschlüsseln äquivalent zu Mixmaster.
- Vor Weiterleitung überprüft Remailer Integrität der Nachricht (wie Mixmaster)
- Dann baut Remailer verschlüsselte Verbindung (TLS) zum nächsten Remailer auf.
-- sym. Schlüssel dafür findet er in Header (Master Secret)
- Dann Weiterleitung

- Verhalten beim Übergang zw. ersten Teil und zweiten Teil des Pfades (swap-Operation? genauer Herausfinden...)


\section{Sicherheitsanalyse}
- theoretisch sicherster Remailer
- aber praktisch nicht nachzuweisen
- da nie in den praktischen Einsatz gekommen (blieb im Beta-Stadium, wurde nie fertig entwickelt).


