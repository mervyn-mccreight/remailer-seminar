\chapter{Typ-II Remailer}
\section{Motivation}
Das Mixmaster-Remailer Protokoll ist seit 1995 verfügbar. Die Motiviation und gleichzeitig das Ziel der Entwicklung der Typ-II Remailer war, die Schwächen der Typ-I-Remailer Generation zu beseitigen. Die wesentlichen Konzepte zur Umsetzung und Verbesserung wurden von Lance Cottrell in seiner Ausarbeitung "{}Mixmaster and remailer attacks"{} erarbeitet. In dieser legt er die Schwächen der Cypherpunk-Remailer offen und analysiert, wodurch diese entstehen, und stellt konkrete Vorschläge dar, wie die vorhandenen Sicherheitslücken möglicherweise zu umgehen sind. So erörtert er unter Anderem, dass und aus welchem Grund Cypherpunk-Remailer nicht zuverlässig verhindern, dass eine Verbindung zwischen eingehenden und ausgehenden Nachrichten an einem Knoten im Remailer-Netzwerk hergestellt werden kann\footnote{vgl. S. 276 \cite{oram2001peer}}. Damit entwarf und implementierte Lance Cottrell das erste Design des Mixmaster Protokolls \footnote{vgl. \cite{mixmastermanpage} - zuletzt aufgerufen am 17.10.2015}.

\section{Funktionsweise}
- benötigt anders als Cypherpunk-Protokoll einen Client.

Das Mixmaster-Remailer Protokoll basiert, analog zum Cypherpunk-Remailer Protokoll, auf einem Netzwerk von Remailern, ähnlich einem Chaum'schen Mix-Netzwerk. Das Verfahren, nach dem eine Nachricht die verschiedenen Knoten des Netzwerks traversiert, bleibt größtenteils identisch. Auch hier wird ein asymmetrisches Verschlüsselungsverfahren verwendet, auf Basis dessen eine Nachricht entsprechend der öffentlichen Schlüssel der Remailer schichtenweise verschlüsselt wird. Hierbei muss der Pfad einer Nachricht im Netzwerk beim schichtenweisen Verschlüsseln der Nachricht bereits bekannt sein. Weiterhin manipuliert ein Remailer nach dem Empfangen und Entschlüsseln einer Nachricht den Nachrichtenheader, um den Absender der Nachricht unkenntlich zu machen. Auf diese Weise wird jede Art von absenderbezogenen Informationen entfernt und die Nachricht anonymisiert. 

Bisher sind alle Schritte identisch dem Cypherpunk-Remailer Protokoll. Um die Schwächen der Typ-I Remailer zu entfernen, benötigte es der Einführung zusätzlicher Sicherheitsmaßnahmen, die im Folgenden erläutert werden.

\subsection{Chunks}
Im Mixmaster-Remailer Protokoll werden Nachrichten in gleichgroße Blöcke \footnote{auch "chunks"} aufgeteilt (beispielsweise 20 kB groß). Entstehen dabei ein oder mehrere Blöcke, die nicht die gewünschte Größe haben, werden diese mit zufällig generierten Daten aufgefüllt. Anstelle der vollständigen Nachricht werden nun die verschiedenen gleichgroßen Blöcke einer Nachricht über das Remailer-Netzwerk verteilt. Zusammengehörende Blöcke müssen hierbei nicht zwangsweise den selben Pfad durch das Netzwerk nehmen. Es ist sogar vorteilhaft, wenn die Blöcke möglichst über unterschiedliche Remailer in dem Netzwerk verteilt werden. Wichtig ist jedoch, dass der letzte Remailer, der die Nachricht schlussendlich an den ursprünglichen Empfänger überträgt, für alle Blöcke einer Nachricht identisch ist. Nur dieser letzte Remailer ist dazu in der Lage, die vollständige Nachricht wiederherzustellen, sofern er alle der Nachricht zugehörigen Blöcke empfangen hat. Anschließend leitet er die Nachricht an Empfänger weiter. Dieses gesamte Verfahren sorgt dafür, dass eine Nachricht nicht mehr anhand ihrer Größe durch das Remailer-Netzwerk verfolgt werden kann. Alle Nachrichten, die innerhalb des Remailer-Netzwerks übertragen werden, sind von gleicher Größe und für einen potentiellen Angreifer Eve identisch. Eine Zuordnung ist auf diese Art und Weise nicht mehr möglich.

\subsection{Pool}
- Nachrichtenpool als Nachrichtenspeicher zum Sammeln.
- Nachrichten aus Pool in zufälliger Reihenfolge wieder versenden. <- Verhindert Verfolgung anhand von Zeitpunkt
- Wenn Pool nicht rechtzeitig voll, füllt Remailer Pool mit Dummy-Nachrichten und schickt sie auch raus.

\subsection{Signatur}
- Integritätscheck von Nachrichten über Signatur. <- Verhindert das Einführen manipulierter Nachrichten.
- Signatur enthält auch "Seriennummer" für Nachricht <- Verhindert mehrfach behandeln derselben Nachricht. Nachricht wird dann empfangen, aber ignoriert, also nicht in Pool gespeichert und weggeworfen.

\section{Sicherheitsanalyse}
- gilt als sicher
- nur theoretischer Angriff denkbar
Ein Angreifer hält die Nachricht, deren Empfänger er herausfinden möchte, zurück. Danach sendet er eigene Nachrichten an den Mixmaster. Dies macht er solange bis der Nachrichtenpool des Mixmasters mit seinen Nachrichten gefüllt ist. Danach schickt er die zurückgehaltene Nachricht los. Alle Nachrichten, die durch den Mixmaster gehen, werden entweder an den Angreifer oder aber an eine dritte Adresse gesendet. Die dritte Adresse ist die des Empfängers der zurückgehaltenen Nachricht.