\chapter{Typ-II Remailer}
\section{Motivation}
Das Mixmaster-Remailer Protokoll ist seit 1995 verfügbar. Die Motiviation und gleichzeitig das Ziel der Entwicklung der Typ-II Remailer war, die Schwächen der Typ-I-Remailer Generation zu beseitigen. Die wesentlichen Konzepte zur Umsetzung und Verbesserung wurden von Lance Cottrell in seiner Ausarbeitung "{}Mixmaster and remailer attacks"{} erarbeitet. In dieser legt er die Schwächen der Cypherpunk-Remailer offen und analysiert, wodurch diese entstehen, und stellt konkrete Vorschläge dar, wie die vorhandenen Sicherheitslücken möglicherweise zu umgehen sind. So erörtert er unter Anderem, dass und aus welchem Grund Cypherpunk-Remailer nicht zuverlässig verhindern, dass eine Verbindung zwischen eingehenden und ausgehenden Nachrichten an einem Knoten im Remailer-Netzwerk hergestellt werden kann\footnote{vgl. S. 276 \cite{oram2001peer}}. Damit entwarf und implementierte Lance Cottrell das erste Design des Mixmaster Protokolls \footnote{vgl. \cite{mixmastermanpage} - zuletzt aufgerufen am 17.10.2015}.

\section{Funktionsweise}
Das Mixmaster-Remailer Protokoll basiert, analog zum Cypherpunk-Remailer Protokoll, auf einem Netzwerk von Remailern, ähnlich einem Chaum'schen Mix-Netzwerk. Das Verfahren, nach dem eine Nachricht die verschiedenen Knoten des Netzwerks traversiert, bleibt größtenteils identisch. Auch hier wird ein asymmetrisches Verschlüsselungsverfahren verwendet, auf Basis dessen eine Nachricht entsprechend der öffentlichen Schlüssel der Remailer schichtenweise verschlüsselt wird. Hierbei muss der Pfad einer Nachricht im Netzwerk beim schichtenweisen Verschlüsseln der Nachricht bereits bekannt sein. Weiterhin manipuliert ein Remailer nach dem Empfangen und Entschlüsseln einer Nachricht den Nachrichtenheader, um den Absender der Nachricht unkenntlich zu machen. Auf diese Weise wird jede Art von absenderbezogenen Informationen entfernt und die Nachricht anonymisiert. 

Bisher sind alle Schritte identisch dem Cypherpunk-Remailer Protokoll. Um die Schwächen der Typ-I Remailer zu entfernen, benötigte es der Einführung zusätzlicher Sicherheitsmaßnahmen, die im Folgenden erläutert werden.

Da die Aufbereitung einer Nachricht für das Mixmaster-Remailer Protokoll durch die zusätzlich eingeführten Sicherheitsmechanismen sehr komplex geworden ist, existiert Client-Software für das Mixmaster-Remailer Protokoll, die das Vorbereiten einer Nachricht für einen Anwender übernehmen. Da Mixmaster-Remailer nur noch Nachrichten akzeptieren, die genau dem spezifizierten Protokoll entsprechen, ist die Verwendung einer Client-Software notwendig. Möchte Alice nun eine Nachricht über Mixmaster-Remailer an Bob senden, muss sie anders als bei Cypherpunk-Remailern die Vorarbeit nicht manuell durchführen. Stattdessen verwendet sie die Client-Software.

\subsection{Chunks}
Im Mixmaster-Remailer Protokoll werden Nachrichten in gleichgroße Blöcke \footnote{auch "chunks"} aufgeteilt (beispielsweise 20 kB groß). Entstehen dabei ein oder mehrere Blöcke, die nicht die gewünschte Größe haben, werden diese mit zufällig generierten Daten aufgefüllt. Anstelle der vollständigen Nachricht werden nun die verschiedenen gleichgroßen Blöcke einer Nachricht über das Remailer-Netzwerk verteilt. Zusammengehörende Blöcke müssen hierbei nicht zwangsweise den selben Pfad durch das Netzwerk nehmen. Es ist sogar vorteilhaft, wenn die Blöcke möglichst über unterschiedliche Remailer in dem Netzwerk verteilt werden. Wichtig ist jedoch, dass der letzte Remailer, der die Nachricht schlussendlich an den ursprünglichen Empfänger überträgt, für alle Blöcke einer Nachricht identisch ist. Nur dieser letzte Remailer ist dazu in der Lage, die vollständige Nachricht wiederherzustellen, sofern er alle der Nachricht zugehörigen Blöcke empfangen hat. Anschließend leitet er die Nachricht an Empfänger weiter.

\begin{figure}
	\begin{center}
		\def\svgwidth{0.9 \linewidth}
		\input{bilder/typ2_message_exchange.pdf_tex}
		\caption{Exemplarische Nachrichtenübertragung mit Mixmaster-Remailern}
	\end{center}
\end{figure}

Dieses gesamte Verfahren sorgt dafür, dass eine Nachricht nicht mehr anhand ihrer Größe durch das Remailer-Netzwerk verfolgt werden kann. Alle Nachrichten, die innerhalb des Remailer-Netzwerks übertragen werden, sind von gleicher Größe und für einen potentiellen Angreifer Eve identisch. Eine Zuordnung ist auf diese Art und Weise nicht mehr möglich.

\subsection{Pool}
Anders als bei den Cypherpunk-Remailern werden einkommende Nachrichten bei den Mixmaster-Remailern nicht sofort zum Zeitpunkt des Eintreffens weitergeleitet. Stattdessen speichert ein Mixmaster-Remailer seine einkommenden Nachrichten in einem Nachrichtenspeicher zwischen. Dieser Nachrichtenspeicher wird auch Nachrichtenpool genannt. In diesem werden einkommende Nachrichten gesammelt. Wichtig ist, dass die Reihenfolge der Nachrichtenspeicherung hierbei keinem festen Schema folgt. Einkommende Nachrichten werden in zufälliger Reihenfolge in dem Nachrichtenpool abgelegt. Für jeden Remailer ist ein Größenschwellwert für den Nachrichtenpool individuell konfigurierbar. Zu dem Zeitpunkt, an dem die Größe des Nachrichtenpools diesen Schwellwert übersteigt, werden in ihm befindlichen Nachrichten in zufälliger Reihenfolge an ihren entsprechenden Empfänger weitergeleitet. 

(hier eventuell Grafik?)

Vorstellbar wäre nun, dass ein Remailer nie genügend Nachrichten empfängt um seinen Nachrichtenpool ausreichend zu füllen. Damit die bis dahin im Nachrichtenpool befindlichen Nachrichten nicht blockiert werden, wird nach Ablauf eines individuell festlegbaren Zeitintervalls, der Nachrichtenpool um zufällig generierte Pseudonachrichten erweitert, sodass der Größenschwellwert überschritten wird. Nun werden alle in ihm befindlichen Nachrichten, inklusive der Attrappen, weitergeleitet. 

(hier eventuell Grafik?)

Auf diese Weise ist es einem Angreifer Eve nicht mehr möglich eine Nachricht anhand der Zeit zu verfolgen. Eine Verbindung zwischen Empfangszeitpunkt und Absendezeitpunkt einer Nachricht an einem Remailer kann nicht hergestellt werden. Durch die gleichartigen Nachrichten\footnote{gleichartig bezogen auf ihre Größe} ist es einem Angreifer zusätzlich nicht möglich, überhaupt eine Verbindung zwischen einer einkommenden und einer ausgehenden Nachricht herzustellen. 


\subsection{Signatur}
Weiterhin wurde bei dem Mixmaster-Remailer das Überprüfen der Integrität einer im Remailer-Netzwerk verschickten Nachricht als zusätzlicher Sicherheitsmechanismus eingeführt. Hierfür wird in einem verschlüsselten Header der Nachricht eine Signatur übertragen. Durch das Überprüfen der Signatur ist es einem empfangenen Remailer möglich zu überprüfen ob eine Nachricht entweder abgefangen und manipuliert, oder vollständig fremdeingeführt worden ist. Auf diese Weise ist es einem theoretischen Angreifer Eve nicht mehr möglich, manipulierte Nachrichten in das Remailernetzwerk einzuspielen um das Verhalten auf diese Nachrichten zu analysieren.

\subsection{Identifikation}
Zusätzlich zur Signatur enthält eine Nachricht in einem weiteren verschlüsselten Header noch eine eindeutige Identifikation, üblicherweise eine Nummer. Über diese ID ist es einem Remailer möglich eine Nachricht eindeutig zu erkennen. Dadurch ist er in der Lage zu erkennen, ob er die selbe Nachricht mehrfach empfängt. Hat ein Mixmaster-Remailer eine Nachricht bereits einmal empfangen und sie so weit behandelt, dass er sie in seinem Nachrichtenpool abgelegt, oder sogar weitergeleitet hat, wird er jede weitere Nachricht mit der selben Identifikation ignorieren. Durch das Einführen dieses Sicherheitsmechanismus hat Eve nicht mehr die Möglichkeit, die bei Cypherpunk-Remailern noch möglichen, Replay-Angriffe erfolgreich zu fahren. Fängt Eve eine Nachricht von Alice an einen Remailer ab, und versucht durch das mehrmalige Absenden der Nachricht an einen Remailer das Verhalten zu analysieren, schlägt dies fehl, da mehrfach gesendete Nachrichten ignoriert werden.

\section{Sicherheitsanalyse}
- gilt als sicher
- nur theoretischer Angriff denkbar
Ein Angreifer hält die Nachricht, deren Empfänger er herausfinden möchte, zurück. Danach sendet er eigene Nachrichten an den Mixmaster. Dies macht er solange bis der Nachrichtenpool des Mixmasters mit seinen Nachrichten gefüllt ist. Danach schickt er die zurückgehaltene Nachricht los. Alle Nachrichten, die durch den Mixmaster gehen, werden entweder an den Angreifer oder aber an eine dritte Adresse gesendet. Die dritte Adresse ist die des Empfängers der zurückgehaltenen Nachricht.